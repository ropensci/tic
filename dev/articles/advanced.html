<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Advanced usage • tic</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="/apple-touch-icon.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><!-- ropensci --><link href="../ropensci.css?nocache=123" rel="stylesheet">
<meta property="og:title" content="Advanced usage">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<meta name="robots" content="noindex">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-462421-8"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-462421-8');
</script>
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://ropensci.org"><img src="https://ropensci.org/img/icon_short_white.svg" id="hexlogo" alt="rOpenSci"></a>
        <a class="navbar-brand" href="../index.html"><i>tic <small>v0.3.0.9005</small></i></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/features.html">Feature Overview</a>
    </li>
    <li>
      <a href="../articles/build-lifecycle.html">The CI Build Lifecycle</a>
    </li>
    <li>
      <a href="../articles/ci-client-packages.html">CI Client Packages</a>
    </li>
    <li>
      <a href="../articles/advanced.html">Advanced Usage</a>
    </li>
    <li>
      <a href="../articles/deployment.html">Deployment</a>
    </li>
    <li>
      <a href="../articles/custom-steps.html">Custom Steps</a>
    </li>
    <li>
      <a href="../articles/org-vs-com.html">Travis CI .org vs .com</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
        <li>
  <a href="https://github.com/ropensci/tic">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Advanced usage</h1>
                        <h4 class="author">Patrick Schratz, Kirill Müller</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropensci/tic/blob/master/vignettes/advanced.Rmd"><code>vignettes/advanced.Rmd</code></a></small>
      <div class="hidden name"><code>advanced.Rmd</code></div>

    </div>

    
    
<div id="running-steps-conditionally" class="section level2">
<h2 class="hasAnchor">
<a href="#running-steps-conditionally" class="anchor"></a>Running steps conditionally</h2>
<p>Steps and stages can be run conditionally using the control workflow of {tic}. Possible conditionals are</p>
<ul>
<li>Environment variables of the build (queried by <code><a href="../reference/ci.html">ci_is_env()</a></code>, <code><a href="../reference/ci.html">ci_has_env()</a></code> or <code><a href="../reference/ci.html">ci_get_env()</a></code>)</li>
<li>R Version of the current build (<code><a href="https://rdrr.io/r/base/numeric_version.html">getRversion()</a></code>)</li>
<li>other features of the build (e.g. branch name via <code><a href="../reference/ci.html">ci_get_branch()</a></code>)</li>
</ul>
<p>Most common tasks are the testing on multiple R versions and the restriction of certain tasks that should only be executed once (e.g. the <a href="deployment.html#pkgdown-deployment">deployment of a {pkgdown} site</a>).</p>
<div id="conditional-execution-use-cases" class="section level3">
<h3 class="hasAnchor">
<a href="#conditional-execution-use-cases" class="anchor"></a>Conditional execution: Use cases</h3>
<p>The following shows some example code blocks to condition certain stages and their respective steps on</p>
<ul>
<li>the R Version (using an environment variable)</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># this env var already exists by default on Travis</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co"># for other systems you need to set a custom env var in the CI YAML</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="cf">if</span> (<span class="kw"><a href="../reference/ci.html">ci_is_env</a></span>(<span class="st">"TRAVIS_R_VERSION_STRING"</span>, <span class="st">"release"</span>)) {</a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="kw"><a href="../reference/dsl.html">get_stage</a></span>(<span class="st">"after_success"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="st">    </span><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw">step_...</span>())</a>
<a class="sourceLine" id="cb1-6" data-line-number="6">}</a></code></pre></div>
<ul>
<li>the CI service</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="cf">if</span> (<span class="kw"><a href="../reference/ci.html">ci_on_travis</a></span>()) {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="kw"><a href="../reference/dsl.html">get_stage</a></span>(<span class="st">"&lt;stage&gt;"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw">step_...</span>())</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">}</a></code></pre></div>
<ul>
<li>a specific branch</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="cf">if</span> (<span class="kw"><a href="../reference/ci.html">ci_get_branch</a></span>() <span class="op">==</span><span class="st"> "master"</span>) {</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">  <span class="kw"><a href="../reference/dsl.html">get_stage</a></span>(<span class="st">"&lt;stage&gt;"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw">step_...</span>())</a>
<a class="sourceLine" id="cb3-4" data-line-number="4">}</a></code></pre></div>
</div>
</div>
<div id="installation-of-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-of-packages" class="anchor"></a>Installation of packages</h2>
<p>Required packages are installed based on the Depends/Imports/Suggests fields of the DESCRIPTION file. You should only use the following steps in extraordinary circumstances. An example can be the use of a package in the REAMDE.Rmd file which is not listed within the package’s DESCRIPTION file.</p>
<div id="github-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#github-packages" class="anchor"></a>GitHub packages</h3>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="../reference/dsl.html">get_stage</a></span>(<span class="st">"install"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw"><a href="../reference/step_install_pkg.html">step_install_github</a></span>(<span class="st">"r-lib/rcmdcheck"</span>))</a></code></pre></div>
<p>Note that the underlying <code><a href="https://rdrr.io/pkg/remotes/man/install_github.html">remotes::install_github()</a></code> is vectorized for the <code>repo</code> argument which means you can pass all packages you want to install in a single function call:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw"><a href="../reference/step_install_pkg.html">step_install_github</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"r-lib/rcmdcheck"</span>, <span class="st">"r-lib/usethis"</span>)))</a></code></pre></div>
</div>
<div id="cran-packages" class="section level3">
<h3 class="hasAnchor">
<a href="#cran-packages" class="anchor"></a>CRAN packages</h3>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="../reference/dsl.html">get_stage</a></span>(<span class="st">"install"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw"><a href="../reference/step_install_pkg.html">step_install_cran</a></span>(<span class="st">"magick"</span>))</a></code></pre></div>
</div>
</div>
<div id="ci-meta-information" class="section level2">
<h2 class="hasAnchor">
<a href="#ci-meta-information" class="anchor"></a>CI Meta-Information</h2>
<p>The <code><a href="../reference/ci.html">ci()</a></code> function and its friends (<code>ci_*</code>) hold valuable information about the CI system. They can be used to query information that can be again be utilized for conditioning stages or steps.</p>
<p>For example, the user may wish to only deploy on Travis CI by using <code><a href="../reference/ci.html">ci_on_travis()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="cf">if</span> (<span class="kw"><a href="../reference/ci.html">ci_on_travis</a></span>()) {</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">  <span class="kw"><a href="../reference/dsl.html">get_stage</a></span>(<span class="st">"before_deploy"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw"><a href="../reference/step_setup_ssh.html">step_setup_ssh</a></span>())</a>
<a class="sourceLine" id="cb7-4" data-line-number="4"></a>
<a class="sourceLine" id="cb7-5" data-line-number="5">  <span class="kw"><a href="../reference/dsl.html">get_stage</a></span>(<span class="st">"deploy"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb7-6" data-line-number="6"><span class="st">    </span><span class="kw"><a href="../reference/dsl.html">add_step</a></span>(<span class="kw"><a href="../reference/step_push_deploy.html">step_push_deploy</a></span>())</a>
<a class="sourceLine" id="cb7-7" data-line-number="7">}</a></code></pre></div>
<p>By using the code above, the specified steps will only be executed on Travis CI. See <code><a href="../reference/ci.html">?ci</a></code> for more information on which CI build information can be extracted from this function.</p>
</div>
<div id="troubleshooting-running-tic-locally" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting-running-tic-locally" class="anchor"></a>Troubleshooting: Running tic locally</h2>
<div id="checking-for-syntax-errors" class="section level3">
<h3 class="hasAnchor">
<a href="#checking-for-syntax-errors" class="anchor"></a>Checking for syntax errors</h3>
<p>Before pushing to GitHub and triggering a CI build, <code>tic.R</code> can be validated using <code><a href="../reference/dsl_get.html">dsl_load()</a></code>. This function will source <code>tic.R</code> to check for possible problems. If everything is ok, it will return (invisibly) a list with all stages that will be run in the CI build. Here is a preview of the first two stages:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="../reference/dsl_get.html">dsl_load</a></span>()</a></code></pre></div>
<pre><code>✔ Loading tic stage configuration from tic.R</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="../reference/dsl_get.html">dsl_get</a></span>()[<span class="dv">1</span><span class="op">:</span><span class="dv">2</span>]</a></code></pre></div>
<pre><code>$before_install
── before_install ──────────────────────────────────────── stage ──
ℹ No steps defined

$install
── install ─────────────────────────────────────────────── stage ──
▶ step_install_github("ropensci/rotemplate")
▶ step_install_deps(repos = repo_default())</code></pre>
</div>
<div id="emulating-a-ci-run-locally" class="section level3">
<h3 class="hasAnchor">
<a href="#emulating-a-ci-run-locally" class="anchor"></a>Emulating a CI run locally</h3>
<p>A tic configuration can be emulated locally.</p>
<p>First, ensure that all prerequisites are met:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1"><span class="kw"><a href="../reference/prepare_all_stages.html">prepare_all_stages</a></span>()</a></code></pre></div>
<p>This might install additional packages, or even fail with a descriptive message.</p>
<p>Then, run all steps defined in <code>tic.R</code>:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="kw"><a href="../reference/run_all_stages.html">run_all_stages</a></span>()</a></code></pre></div>
<p>This emulates a CI run on your local machine by executing all stages and their corresponding steps. Note that this action this will use your local system libraries and not the CI environment. Only the steps that are shown with <code><a href="../reference/dsl_get.html">dsl_get()</a></code> are executed. Some steps will not be executed as they are conditioned to run on non-interactive environments only, e.g. <code><a href="../reference/dsl.html">add_step(covr::codcov())</a></code> added by the macro <code><a href="../reference/do_package_checks.html">do_package_checks()</a></code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="../reference/run_all_stages.html">run_all_stages</a></span>()</a></code></pre></div>
<pre><code>✓ Loading tic stage configuration from tic.R
Running install: step_install_github("ropensci/rotemplate")
Skipping install of 'rotemplate' from a github remote, the SHA1 (bec3e6eb) has not changed since last install.
  Use `force = TRUE` to force installation
Running install: step_install_deps(repos = repo_default())</code></pre>
</div>
</div>
<div id="troubleshooting-entering-the-ci-build-directly" class="section level2">
<h2 class="hasAnchor">
<a href="#troubleshooting-entering-the-ci-build-directly" class="anchor"></a>Troubleshooting: Entering the CI build directly</h2>
<div id="travis-ci" class="section level3">
<h3 class="hasAnchor">
<a href="#travis-ci" class="anchor"></a>Travis CI</h3>
<p>If your build fails and you don’t understand why (error messages are too unspecific, you cannot reproduce the problem locally), you can SSH into the build to debug it. To do so, your repository must be enabled on Travis CI for “ssh debugging”. Unfortunately you need to take manual action by contacting Travis CI via e-mail, asking whether they can activate your repo for <a href="https://docs.travis-ci.com/user/running-build-in-debug-mode/#enabling-debug-mode">ssh debugging</a>. Usually you get a reply within one day including additional information. After that, you either follow the manual instructions you get via mail or take the easy way: <code><a href="https://rdrr.io/pkg/travis/man/travis_get_builds.html">travis::travis_debug_job()</a></code>.</p>
<p>All it needs is the “Job ID” of the respective build you want to enter.</p>
<p><img src="img/travis-job-id.png" style="display: block; margin: auto;"></p>
<p>Rather than going to the web interface and getting the “Job ID” there, you can also do this from the command line. First, you need to query the overall “Build ID” of the run:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">travis<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/travis/man/travis_get_builds.html">travis_get_builds</a></span>()</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="ex">A</span> collection of 25 Travis CI builds:</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="ex">-</span> id: 416858821, number: 342, state: errored, duration: 3820, event_type: push, ...</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="ex">-</span> id: 416834229, number: 341, state: errored, duration: 3738, event_type: push, ...</a>
<a class="sourceLine" id="cb17-4" data-line-number="4"><span class="ex">-</span> id: 416135954, number: 340, state: errored, duration: 3338, event_type: push, ...</a>
<a class="sourceLine" id="cb17-5" data-line-number="5"><span class="ex">-</span> id: 416107143, number: 339, state: errored, duration: 3670, event_type: push, ...</a>
<a class="sourceLine" id="cb17-6" data-line-number="6"><span class="ex">-</span> id: 416095854, number: 338, state: passed, duration: 3135, event_type: push, ...</a></code></pre></div>
<p>Because every “build” has multiple “Jobs”, you can now query the “Job ID”. For example, when you know that you want to debug the latest build, you can combine both commands:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">build_id &lt;-<span class="st"> </span>travis<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/travis/man/travis_get_builds.html">travis_get_builds</a></span>()[[<span class="dv">1</span>]]<span class="op">$</span>id</a>
<a class="sourceLine" id="cb18-2" data-line-number="2">travis<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/travis/man/travis_get_builds.html">travis_get_jobs</a></span>(build_id)</a></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="ex">A</span> collection of 7 Travis CI jobs:</a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="ex">-</span> id: 416858822, allow_failure: FALSE, number: 342.1, state: passed, started_at: 2018-08-16T15:02:52Z, ...</a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="ex">-</span> id: 416858823, allow_failure: FALSE, number: 342.2, state: passed, started_at: 2018-08-16T15:02:18Z, ...</a>
<a class="sourceLine" id="cb19-4" data-line-number="4"><span class="ex">-</span> id: 416858824, allow_failure: FALSE, number: 342.3, state: passed, started_at: 2018-08-16T15:02:43Z, ...</a>
<a class="sourceLine" id="cb19-5" data-line-number="5"><span class="ex">-</span> id: 416858825, allow_failure: FALSE, number: 342.4, state: passed, started_at: 2018-08-16T15:02:23Z, ...</a>
<a class="sourceLine" id="cb19-6" data-line-number="6"><span class="ex">-</span> id: 416858826, allow_failure: FALSE, number: 342.5, state: passed, started_at: 2018-08-16T15:02:23Z, ...</a></code></pre></div>
<p>Finally, the build can be restarted by calling <code><a href="https://rdrr.io/pkg/travis/man/travis_get_builds.html">travis::travis_debug_job()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">job_id &lt;-<span class="st"> </span>travis<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/travis/man/travis_get_builds.html">travis_get_jobs</a></span>(build_id)[[<span class="dv">1</span>]]<span class="op">$</span>id</a>
<a class="sourceLine" id="cb20-2" data-line-number="2">travis<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/travis/man/travis_get_builds.html">travis_debug_job</a></span>(job_id)</a></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="ex">Finished</span> restarting debug job 416983664 from Travis CI.</a></code></pre></div>
<p>Wait a few minutes until the build arrives at the point when it shows the SSH command that can be used to enter the build. It should look similar to <code>ssh ukjiuCEkxBBnRAe32Y8xCH0zj@ny2.tmate.io</code>. If you still do not want to use the browser manually, simple call <code>travis::browse()</code> to open your project on Travis.</p>
<p>Once you are in the build you can use <code>bash</code> functions defined by Travis to to execute specific stages:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode sh"><code class="sourceCode bash"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="ex">travis_run_before_install</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="ex">travis_run_install</span></a>
<a class="sourceLine" id="cb22-3" data-line-number="3"><span class="ex">travis_run_before_script</span></a>
<a class="sourceLine" id="cb22-4" data-line-number="4"><span class="ex">travis_run_script</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"><span class="ex">travis_run_after_success</span></a>
<a class="sourceLine" id="cb22-6" data-line-number="6"><span class="ex">travis_run_after_failure</span></a>
<a class="sourceLine" id="cb22-7" data-line-number="7"><span class="ex">travis_run_after_script</span></a></code></pre></div>
<p>The debug session is a VM running a <a href="https://tmate.io/"><code>tmate</code></a> session. This makes it possible to use <code>tmux</code> commands, such as:</p>
<ul>
<li>Create multiple windows with <code>crtl-b c</code>.<br>
</li>
<li>Switch to a different window: <code>crtl-b &lt;window index&gt;</code> where the indices start with 0, 1, 2 and so on.<br>
</li>
<li>Scrolling up and down the history: <code>crtl-b [</code>. Press <code>q</code> to exit the scroll mode.</li>
</ul>
<p>See this <a href="https://tmuxcheatsheet.com/">cheatsheet</a> for more shortcuts.</p>
<p>Keep in mind that you only have 30 minutes before the VM will be terminated automatically.</p>
</div>
<div id="circle-ci" class="section level3">
<h3 class="hasAnchor">
<a href="#circle-ci" class="anchor"></a>Circle CI</h3>
<p>Debugging builds on Circle CI is much easiern than on Travis CI. Go to the web interface and click on the three dots as shown in the screenshot. Then you can restart your build from the appearing dropdown menu and SSH into the build in a the same as way shown for Travis CI.</p>
<p><img src="img/circleci-debug.png" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="whats-not-covered-yet" class="section level1">
<h1 class="hasAnchor">
<a href="#whats-not-covered-yet" class="anchor"></a>What’s not covered yet?</h1>
<ul>
<li>
<code>SystemRequirements</code>: {tic} is not yet capable of automatically determining system requirements specified in DESCRIPTION files of an R package. Our plan is to automatically provide suggestions like “Please add <code>addons: apt: &lt;library&gt;</code> to <code>.travis.yml</code>” in case system requirements are missing.</li>
</ul>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#running-steps-conditionally">Running steps conditionally</a><ul class="nav nav-pills nav-stacked">
<li><a href="#conditional-execution-use-cases">Conditional execution: Use cases</a></li>
      </ul>
</li>
      <li>
<a href="#installation-of-packages">Installation of packages</a><ul class="nav nav-pills nav-stacked">
<li><a href="#github-packages">GitHub packages</a></li>
      <li><a href="#cran-packages">CRAN packages</a></li>
      </ul>
</li>
      <li><a href="#ci-meta-information">CI Meta-Information</a></li>
      <li>
<a href="#troubleshooting-running-tic-locally">Troubleshooting: Running tic locally</a><ul class="nav nav-pills nav-stacked">
<li><a href="#checking-for-syntax-errors">Checking for syntax errors</a></li>
      <li><a href="#emulating-a-ci-run-locally">Emulating a CI run locally</a></li>
      </ul>
</li>
      <li>
<a href="#troubleshooting-entering-the-ci-build-directly">Troubleshooting: Entering the CI build directly</a><ul class="nav nav-pills nav-stacked">
<li><a href="#travis-ci">Travis CI</a></li>
      <li><a href="#circle-ci">Circle CI</a></li>
      </ul>
</li>
      <li><a href="#whats-not-covered-yet">What’s not covered yet?</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><!-- begin footer --><div class="footer">
    <div class="container">
        <div class="row start bottom-8">
            <div class="col-xs-2"> <img id="footerlogo" src="https://ropensci.org/img/icon_short_white.svg">
</div>
            <div class="col-xs-10">
                <div class="row">
                    <div class="col-md-4 col-xs-6">
                        <a href="http://github.com/ropensci" target="_blank"><div class="icon fab fa-github"></div></a>
                        <a href="http://github.com/ropenscilabs" target="_blank"><div class="icon fa fa-flask"></div></a>
                        <a href="http://twitter.com/ropensci" target="_blank"><div class="icon fab fa-twitter"></div></a>
                        <a href="http://vimeo.com/ropensci" target="_blank"><div class="icon fab fa-vimeo"></div></a>
                    </div>
                </div>
                <div class="row top-4">
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Info</h5>
                            <li><a href="https://ropensci.org/about">Mission</a></li>
                            <li><a href="https://ropensci.org/about#team">Team</a></li>
                            <li><a href="https://ropensci.org/about#collaborators">Collaborators</a></li>
                            <li><a href="https://ropensci.org/careers">Careers</a></li>
                        </ul>
</div>
                    <div class="col-md-2 col-sm-4">
                        <ul>
<h5 class="bottom-2">Work</h5>
                            <li><a href="https://ropensci.org/packages/">Packages</a></li>
                            <li><a href="https://ropensci.org/blog/">Blog</a></li>
                            <li><a href="https://ropensci.org/technotes/">Tech Notes</a></li>
                            <li><a href="https://ropensci.org/tutorials/">Tutorials</a></li>
                            <li><a href="https://ropensci.org/usecases/">Use Cases</a></li>
                            <li><a href="https://ropensci.org/resources/">More Resources</a></li>
                        </ul>
</div>
                    <div class="col-md-3 col-sm-4">
                        <ul>
<h5 class="bottom-2">Participate</h5>
                            <li><a href="https://ropensci.org/contact/">Contact us</a></li>
                            <li><a href="https://ropensci.org/community/">Community</a></li>
                            <li><a href="https://ropensci.org/software-review/">Contribute software</a></li>
                            <li><a href="https://ropensci.org/code-of-conduct">Code of conduct</a></li>
                            <li><a href="https://ropensci.org/events/">Events</a></li>
                            <li><a href="https://ropensci.org/commcalls/">Community calls</a></li>
                            <li><a href="https://ropensci.org/donate/">Donate</a></li>
                        </ul>
</div>
                    <div class="col-md-4 col-xs-12">
                        <h5 class="bottom-2"></h5>

                        <p>rOpenSci is a fiscally sponsored project of <a href="http://numfocus.org" target="_blank">NumFOCUS</a></p>
                        <a href="http://numfocus.org" target="_blank"></a>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- / end footer -->

      </footer>
</div>

  


  </body>
</html>
