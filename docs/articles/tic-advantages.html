<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The advantages of tic • tic</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The advantages of tic">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tic</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.13.9008</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tic.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tic-advantages.html">tic advantages</a>
    </li>
    <li>
      <a href="../articles/tic-usethis-travis.html">tic, travis and usethis</a>
    </li>
    <li>
      <a href="../articles/build-lifecycle.html">Build lifecycle</a>
    </li>
    <li>
      <a href="../articles/advanced.html">Advanced usage</a>
    </li>
    <li>
      <a href="../articles/custom-steps.html">Dev - custom steps</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/ropenscilabs/tic">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>The advantages of tic</h1>
                        <h4 class="author">Patrick Schratz, Kirill Müller</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ropenscilabs/tic/blob/master/vignettes/tic-advantages.Rmd"><code>vignettes/tic-advantages.Rmd</code></a></small>
      <div class="hidden name"><code>tic-advantages.Rmd</code></div>

    </div>

    
    
<div id="the-advantages-of-tic" class="section level1">
<h1 class="hasAnchor">
<a href="#the-advantages-of-tic" class="anchor"></a>The advantages of tic</h1>
<p>So, what’s the advantage of using <code>tic</code> over the standard CI process?</p>
<ul>
<li>CI-agnostic workflow definitions (in R!)</li>
<li>Simplified deployment (e.g. <code>pkgdown</code> site)</li>
<li>Improved package checking via <a href="https://github.com/r-lib/rcmdcheck">rcmdcheck</a>
</li>
<li>Robust caching approach</li>
</ul>
<div id="ci-agnostic-workflows" class="section level2">
<h2 class="hasAnchor">
<a href="#ci-agnostic-workflows" class="anchor"></a>CI-Agnostic workflows</h2>
<p>What does “CI-Agnostic” mean and why do we need it?</p>
<p>You may have heard that multiple CI services exist in the wild. Some are OS specific (e.g. Appveyor = Windows), some only support certain languages and for some you need to pay a monthly rate to use them. What all have in common: They have their own way to specify their setup file, which is most often written in YAML and stored at the top-level directory of your repo. This setup file controls what will be done in each run.</p>
<p>To give you an example how different these files can be, take a look at these two examples from <a href="https://github.com/tidyverse/dplyr/blob/master/.travis.yml">Travis</a> and <a href="https://github.com/tidyverse/dplyr/blob/master/appveyor.yml">Appveyor</a>. While <code>Travis</code> is the only free CI services with a stable support for R (maintained by the community, specifically by <span class="citation">@jimhester</span>), <code>Appveyor</code> currently requires quite some magic (e.g. <code>travis-tool.sh</code>) in the background to install a working R framework in the first place.</p>
<p>We could list way more differences - but that’s exactly the point when <code>tic</code> comes in! Rather than dealing with all the CI differences, <code>tic</code> enables the specification of the complete workflow in an external R script file <code>tic.R</code>. The commands specified in there will be understood on every CI service that is supported by <code>tic</code>. Furthermore, you can emulate all the stages and steps locally by calling <code><a href="../reference/tic.html">tic()</a></code>. And you are independent of all the changes that are being made on the R setup for Travis or Appveyor [LINKS TO SETUPS].</p>
<p>So instead of learning how to specify one specific task on different CI platforms, the user only needs to get used to the R based approach of <code>tic</code>.</p>
</div>
<div id="easier-deployment" class="section level2">
<h2 class="hasAnchor">
<a href="#easier-deployment" class="anchor"></a>Easier deployment</h2>
<p>You may know that CI services can be used to automatically deploy files. This means that these services can push certain files created during the build to repositories (Github, Gitlab, etc.). A common use case is to build your <code>pkgdown</code> site and conditionally push changes to your repo. This practice saves you from building the whole <code>pkgdown</code> site locally and then committing manually all the changed files - Travis will do it for you! <code>tic</code> takes care of all the setup work (setting up ssh keys, permission granting for the repo on Github and Travis). In combination with <code>usethis::use_ci()</code> this whole preparation process is streamlined and needs only be called once for every repo by the user.</p>
<p>Today, it becomes more and more the standard to have a <code>pkgdown</code> site for a R package which presents all the well-written vignettes and function documentations in a nicely styled web version. But this is only valuable if the information also reflects the most recent state of the repo. Do not waste time on updating your site manually - automate such tasks!</p>
<p><code>tic</code> initiates the deployment in the <code>.travis.yml</code> file with the following block:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode yml"><code class="sourceCode yaml"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="fu">before_deploy:</span><span class="at"> R -q -e 'tic::before_deploy()'</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="fu">deploy:</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3">  <span class="fu">provider:</span><span class="at"> script</span></a>
<a class="sourceLine" id="cb1-4" data-line-number="4">  <span class="fu">script:</span><span class="at"> R -q -e 'tic::deploy()'</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5">  <span class="fu">on:</span></a>
<a class="sourceLine" id="cb1-6" data-line-number="6">    <span class="fu">all_branches:</span><span class="at"> true</span></a></code></pre></div>
<p>Let’s break down what happens here:</p>
<ol style="list-style-type: decimal">
<li>Travis executes <code><a href="../reference/stages.html">tic::before_deploy()</a></code> which will search for instructions regarding the <code><a href="../reference/stages.html">before_deploy()</a></code> stage in <code>tic.R</code>. By default this looks like</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="cf">if</span> (<span class="kw">Sys.getenv</span>(<span class="st">"BUILD_PKGDOWN"</span>) <span class="op">!=</span><span class="st"> ""</span>) {</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">  <span class="kw"><a href="../reference/DSL.html">get_stage</a></span>(<span class="st">"before_deploy"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="st">    </span><span class="kw"><a href="../reference/DSL.html">add_step</a></span>(<span class="kw"><a href="../reference/step_setup_ssh.html">step_setup_ssh</a></span>())</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">}</a></code></pre></div>
<p>This block finally executes the function <code>step_setup_ ssh()</code> if the environment variable <code>"BUILD_PKGDOWN"</code> is set in the Travis build. That is just one condition among many that you can set to run certain commands (or stages) conditionally (see <a href="advanced.html#running-stages-conditionally">here</a> for more examples). After the prerequisite of setting up an ssh key for the upcoming deployment has been finished,</p>
<ol start="2" style="list-style-type: decimal">
<li>Travis is told to use a “script” (provider: script) for the deployment (which holds further instructions).</li>
<li>This “script” is then calling <code><a href="../reference/stages.html">tic::deploy()</a></code>.</li>
<li>All this is only happening on the <code>master</code> branch, meaning that other branches do not trigger a deploy with this condition set.</li>
</ol>
<p>What happens now is that <code><a href="../reference/stages.html">tic::deploy()</a></code> again searches in <code>tic.R</code> for the “deploy” stage and then runs whatever you have specified there.</p>
<p>With the default template of <code>tic.R</code>, the following will be executed:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="../reference/DSL.html">get_stage</a></span>(<span class="st">"deploy"</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb3-2" data-line-number="2"><span class="st">  </span><span class="kw"><a href="../reference/DSL.html">add_step</a></span>(<span class="kw"><a href="../reference/step_build_pkgdown.html">step_build_pkgdown</a></span>()) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="st">  </span><span class="kw"><a href="../reference/DSL.html">add_step</a></span>(<span class="kw"><a href="../reference/step_push_deploy.html">step_push_deploy</a></span>())</a></code></pre></div>
<p>First, <code><a href="../reference/step_build_pkgdown.html">step_build_pkgdown()</a></code> will build your <code>pkgdown</code> site and afterwards (note the <code>pipe</code> operator), <code><a href="../reference/step_push_deploy.html">step_push_deploy()</a></code> takes care to push the results to your repo. By default this will be the <code>docs/</code> directory of the <code>master</code> branch.</p>
</div>
<div id="rcmdcheck-r-cmd-check" class="section level2">
<h2 class="hasAnchor">
<a href="#rcmdcheck-r-cmd-check" class="anchor"></a><code>rcmdcheck()</code> &gt; R CMD check</h2>
<p>Usually Travis will run <code>R CMD check</code> to check the R package. <code>tic</code> instead uses <a href="https://github.com/r-lib/rcmdcheck"><code>rcmdcheck</code></a>, an optimized version of <code>R CMD check</code> developed by <a href="https://github.com/gaborcsardi">Gabor Csardi</a>. It comes with several enhancements:</p>
<ul>
<li>Coloring of important steps on Travis, simplifying the readability of the log</li>
<li>Enhanced and extended tracebacks of errors, especially errors in tests</li>
</ul>
<p>Especially the extended log printing of errors is a huge advantage - often enough, the important information is not printed by Travis when using <code>R CMD check</code> making it hard for the user to debug the problem.</p>
</div>
<div id="caching-of-packages" class="section level2">
<h2 class="hasAnchor">
<a href="#caching-of-packages" class="anchor"></a>Caching of packages</h2>
<p>When using <code>tic</code> all dependencies (not only the ones of the package) are installed in the “before_install” stage. This has the advantage that all packages get added to the cache (even if they are just needed for deployment), speeding up subsequent builds substantially.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#the-advantages-of-tic">The advantages of tic</a><ul class="nav nav-pills nav-stacked">
<li><a href="#ci-agnostic-workflows">CI-Agnostic workflows</a></li>
      <li><a href="#easier-deployment">Easier deployment</a></li>
      <li><a href="#rcmdcheck-r-cmd-check"><code>rcmdcheck()</code> &gt; R CMD check</a></li>
      <li><a href="#caching-of-packages">Caching of packages</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Kirill Müller, Mika Braginsky, Karthik Ram, Jeroen Ooms, Patrick Schratz, rOpenSci.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
